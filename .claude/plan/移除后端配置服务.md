# å®æ–½è®¡åˆ’ï¼šç§»é™¤åç«¯é…ç½®æœåŠ¡

> **ç”Ÿæˆæ—¶é—´**: 2026-01-22
> **æ–¹æ¡ˆ**: æ–¹æ¡ˆ 1 - ä¸¥æ ¼ç§»é™¤
> **Codex Session**: 019be61b-c58f-7e31-a2b3-cd6480168f69

---

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

**ç›®æ ‡**: å®Œå…¨ç§»é™¤åç«¯é…ç½®æœåŠ¡ï¼Œå‰ç«¯é…ç½®ç¡¬ç¼–ç åœ¨ Home.vue

**ç”¨æˆ·ç¡®è®¤**:
- âœ… é‡‡ç”¨æ–¹æ¡ˆ 1ï¼šå®Œå…¨åˆ é™¤åç«¯é…ç½®æœåŠ¡
- âœ… å‰ç«¯ä½¿ç”¨æ•°æ®é©±åŠ¨è§†å›¾é€»è¾‘ï¼Œé…ç½®ç¡¬ç¼–ç åœ¨ Home.vue
- âœ… æ ·å¼ä¿æŒä¸å˜
- âœ… é…ç½®ç”±å¼€å‘äººå‘˜ç»´æŠ¤ï¼Œä¸ç§»äº¤ç»™ç”¨æˆ·

---

## ğŸ¯ å®æ–½æ­¥éª¤

### é˜¶æ®µ 1ï¼šåç«¯æ¸…ç†

#### 1.1 åˆ é™¤é…ç½® API
**æ–‡ä»¶**: `backend/app/api/config.py`
**æ“ä½œ**: å®Œå…¨åˆ é™¤æ–‡ä»¶

**å½±å“**:
- ç§»é™¤ 3 ä¸ªæ¥å£ï¼šGET /app, PUT /{config_key}, GET /{config_key}
- ç§»é™¤é…ç½®ç®¡ç†è·¯ç”±

#### 1.2 åˆ é™¤é…ç½®æ¨¡å‹
**æ–‡ä»¶**: `backend/app/models/config.py`
**æ“ä½œ**: å®Œå…¨åˆ é™¤æ–‡ä»¶

**å½±å“**:
- ç§»é™¤ Config ORM æ¨¡å‹
- t_config è¡¨ä¸å†è¢« ORM ç®¡ç†

#### 1.3 åˆ é™¤é…ç½® Schema
**æ–‡ä»¶**: `backend/app/schemas/config.py`
**æ“ä½œ**: å®Œå…¨åˆ é™¤æ–‡ä»¶

**å½±å“**:
- ç§»é™¤ AppConfigFrontendã€ConfigUpdateã€ApiResponse ç­‰ Schema

#### 1.4 æ¸…ç†è·¯ç”±æ³¨å†Œ
**æ–‡ä»¶**: `backend/main.py`
**ä½ç½®**: ç¬¬ 41 è¡Œ
**æ“ä½œ**: åˆ é™¤ä»¥ä¸‹ä»£ç 
```python
app.include_router(config.router, prefix="/api/v1/config", tags=["é…ç½®ç®¡ç†"])
```

**åŒæ—¶åˆ é™¤å¯¼å…¥**:
```python
from app.api import config
```

#### 1.5 æ¸…ç†æ•°æ®åº“åˆå§‹åŒ–
**æ–‡ä»¶**: `backend/app/core/init_db.py`
**æ“ä½œ**: åˆ é™¤é…ç½®åˆå§‹åŒ–ä»£ç ï¼ˆapp_configã€nav_itemsï¼‰

**ä¿®æ”¹å‰**:
```python
def init_database():
    Base.metadata.create_all(bind=engine)
    db = SessionLocal()
    try:
        # åˆå§‹åŒ–é…ç½®æ•°æ®
        app_config = Config(...)
        nav_items = Config(...)
        db.add_all([app_config, nav_items])
        db.commit()
    finally:
        db.close()
```

**ä¿®æ”¹å**:
```python
def init_database():
    Base.metadata.create_all(bind=engine)
    print("æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ")
    print("æ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼")
```

#### 1.6 æ¸…ç†æ•°æ®åº“å·¥å…·
**æ–‡ä»¶**: `backend/app/core/database.py`
**æ“ä½œ**: åˆ é™¤ `init_db()` å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

---

### é˜¶æ®µ 2ï¼šå‰ç«¯æ”¹é€ 

#### 2.1 ä¿®æ”¹ Home.vue
**æ–‡ä»¶**: `frontend/src/views/Home.vue`
**æ“ä½œ**: ç¡¬ç¼–ç é…ç½®æ•°æ®

**ä¿®æ”¹å‰**:
```vue
<script setup>
import { ref, onMounted } from 'vue'
import { getAppConfig } from '@/api/config'

const appTitle = ref('æ²ˆè¥¿æ‰€è­¦åŠ¡å·¥ä½œç®¡å®¶')
const backgroundImage = ref('/main-bg.jpg')
const navItems = ref([])
const loading = ref(true)
const error = ref(null)

const fetchConfig = async () => {
  try {
    loading.value = true
    const config = await getAppConfig()
    appTitle.value = config.title || 'æ²ˆè¥¿æ‰€è­¦åŠ¡å·¥ä½œç®¡å®¶'
    backgroundImage.value = config.backgroundImage || '/main-bg.jpg'
    navItems.value = config.navItems || []
    error.value = null
  } catch (err) {
    console.error('è·å–é…ç½®å¤±è´¥:', err)
    error.value = 'é…ç½®åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é…ç½®'
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  fetchConfig()
})
</script>
```

**ä¿®æ”¹å**:
```vue
<script setup>
import { ref } from 'vue'

// åº”ç”¨é…ç½®ï¼ˆç¡¬ç¼–ç ï¼‰
const appConfig = {
  title: 'æ²ˆè¥¿æ‰€è­¦åŠ¡å·¥ä½œç®¡å®¶',
  primaryColor: '#2c2772',
  backgroundImage: '/main-bg.jpg',
  navItems: [
    {
      "text": "è­¦å‘˜å®šä½",
      "icon": "i-ri-map-pin-user-line",
      "iconEnabled": false,
      "href": "https://www.azliot.com/home/siteMap",
      "external": true
    },
    {
      "text": "è­¦æƒ…æ€åŠ¿ç›‘æ§è¿½è¸ª",
      "icon": "i-ri-dashboard-line",
      "iconEnabled": false,
      "to": "/situation",
      "external": false
    },
    {
      "text": "æ‰§æ³•é—®é¢˜é£é™©ç›¯åŠ",
      "icon": "i-ri-file-list-3-line",
      "iconEnabled": false,
      "to": "/cases",
      "external": false
    },
    {
      "text": "æœªçŸ›ç›¾çº çº·é—­ç¯ç®¡ç†",
      "icon": "i-ri-user-voice-line",
      "iconEnabled": false,
      "to": "/disputes",
      "external": false
    }
  ]
}

// å“åº”å¼å¼•ç”¨ï¼ˆä¿æŒæ•°æ®é©±åŠ¨è§†å›¾ï¼‰
const appTitle = ref(appConfig.title)
const backgroundImage = ref(appConfig.backgroundImage)
const navItems = ref(appConfig.navItems)
</script>
```

**å…³é”®ç‚¹**:
- âœ… ä¿ç•™å“åº”å¼å¼•ç”¨ï¼ˆæ•°æ®é©±åŠ¨è§†å›¾ï¼‰
- âœ… ç§»é™¤ API è°ƒç”¨å’Œå¼‚æ­¥é€»è¾‘
- âœ… ç§»é™¤ loading/error çŠ¶æ€
- âœ… ä¿æŒé…ç½®æ•°æ®ç»“æ„ä¸å˜

#### 2.2 æ¸…ç†é…ç½® API æ–‡ä»¶
**æ–‡ä»¶**: `frontend/src/api/config.js`
**æ“ä½œ**:
- **é€‰é¡¹ A**: å®Œå…¨åˆ é™¤æ–‡ä»¶ï¼ˆå¦‚æœæ²¡æœ‰å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼‰
- **é€‰é¡¹ B**: ä¿ç•™æ–‡ä»¶ä½†æ³¨é‡Šæ‰æ‰€æœ‰å‡½æ•°ï¼ˆå¦‚æœå¯èƒ½è¢«å…¶ä»–åœ°æ–¹å¼•ç”¨ï¼‰

**å»ºè®®**: é€‰é¡¹ Aï¼ˆå®Œå…¨åˆ é™¤ï¼‰

---

### é˜¶æ®µ 3ï¼šæ•°æ®åº“å¤„ç†

#### 3.1 t_config è¡¨å¤„ç†
**çŠ¶æ€**: è¡¨ä¿ç•™åœ¨æ•°æ®åº“ä¸­ï¼Œä½†ä¸å†ä½¿ç”¨

**é€‰é¡¹**:
- **é€‰é¡¹ A**: ä¿ç•™è¡¨ï¼ˆæ¨èï¼‰- ä¸å½±å“ç°æœ‰æ•°æ®åº“
- **é€‰é¡¹ B**: æ‰‹åŠ¨åˆ é™¤è¡¨
  ```sql
  DROP TABLE IF EXISTS t_config;
  ```

**å»ºè®®**: é€‰é¡¹ Aï¼ˆä¿ç•™è¡¨ï¼‰

---

### é˜¶æ®µ 4ï¼šéªŒè¯æµ‹è¯•

#### 4.1 åç«¯éªŒè¯
```bash
# 1. å¯åŠ¨åç«¯
cd backend
python main.py

# 2. æ£€æŸ¥å¯åŠ¨æ—¥å¿—
# é¢„æœŸï¼šæ— å¯¼å…¥é”™è¯¯ï¼Œæ­£å¸¸å¯åŠ¨

# 3. è®¿é—® API æ–‡æ¡£
# http://localhost:8000/docs
# é¢„æœŸï¼šé…ç½®ç®¡ç†æ¥å£ä¸å†æ˜¾ç¤º

# 4. æ£€æŸ¥å¥åº·æ¥å£
curl http://localhost:8000/health
# é¢„æœŸï¼š{"status": "ok"}
```

#### 4.2 å‰ç«¯éªŒè¯
```bash
# 1. å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# 2. è®¿é—®é¦–é¡µ
# http://localhost:3000
# é¢„æœŸï¼šæ­£å¸¸æ˜¾ç¤ºï¼Œé…ç½®ç«‹å³åŠ è½½

# 3. æ£€æŸ¥æ§åˆ¶å°
# é¢„æœŸï¼šæ—  API é”™è¯¯ï¼Œæ—  loading çŠ¶æ€
```

#### 4.3 ä»£ç æ£€æŸ¥
```bash
# æ£€æŸ¥æ˜¯å¦è¿˜æœ‰é…ç½® API å¼•ç”¨
rg -n "api/v1/config" backend frontend
rg -n "getAppConfig" frontend
rg -n "Config" backend/app

# é¢„æœŸï¼šæ— ç›¸å…³å¼•ç”¨
```

---

## ğŸ“Š å½±å“åˆ†æ

### åç«¯å½±å“
| æ–‡ä»¶ | æ“ä½œ | å½±å“ |
|------|------|------|
| `backend/app/api/config.py` | åˆ é™¤ | ç§»é™¤é…ç½® API |
| `backend/app/models/config.py` | åˆ é™¤ | ç§»é™¤ Config æ¨¡å‹ |
| `backend/app/schemas/config.py` | åˆ é™¤ | ç§»é™¤ Schema |
| `backend/main.py` | ä¿®æ”¹ | åˆ é™¤è·¯ç”±æ³¨å†Œ |
| `backend/app/core/init_db.py` | ä¿®æ”¹ | åˆ é™¤é…ç½®åˆå§‹åŒ– |
| `backend/app/core/database.py` | ä¿®æ”¹ | åˆ é™¤ init_db å‡½æ•° |

### å‰ç«¯å½±å“
| æ–‡ä»¶ | æ“ä½œ | å½±å“ |
|------|------|------|
| `frontend/src/views/Home.vue` | ä¿®æ”¹ | ç¡¬ç¼–ç é…ç½® |
| `frontend/src/api/config.js` | åˆ é™¤ | ç§»é™¤é…ç½® API è°ƒç”¨ |

### æ•°æ®åº“å½±å“
| è¡¨ | æ“ä½œ | å½±å“ |
|------|------|------|
| `t_config` | ä¿ç•™ | ä¸å†ä½¿ç”¨ä½†ä¿ç•™ |

---

## âš ï¸ é£é™©è¯„ä¼°

### ä½é£é™©
- âœ… é…ç½®æœåŠ¡å®Œå…¨éš”ç¦»ï¼Œæ— å…¶ä»–æ¨¡å—ä¾èµ–
- âœ… ä»… Home.vue ä½¿ç”¨é…ç½® API
- âœ… æ•°æ®ç»“æ„ä¿æŒä¸å˜

### ä¸­é£é™©
- âš ï¸ å¤±å»è¿è¡Œæ—¶é…ç½®èƒ½åŠ›
- âš ï¸ é…ç½®ä¿®æ”¹éœ€è¦é‡æ–°éƒ¨ç½²

### ç¼“è§£æªæ–½
- ğŸ“ æ–‡æ¡£è®°å½•é…ç½®ä½ç½®
- ğŸ“ æä¾›é…ç½®ä¿®æ”¹æŒ‡å—
- ğŸ“ è€ƒè™‘æœªæ¥ä½¿ç”¨ç¯å¢ƒå˜é‡

---

## ğŸ“ å›æ»šè®¡åˆ’

å¦‚æœéœ€è¦å›æ»šï¼š

1. **æ¢å¤åç«¯æ–‡ä»¶**
   ```bash
   git checkout backend/app/api/config.py
   git checkout backend/app/models/config.py
   git checkout backend/app/schemas/config.py
   git checkout backend/main.py
   git checkout backend/app/core/init_db.py
   ```

2. **æ¢å¤å‰ç«¯æ–‡ä»¶**
   ```bash
   git checkout frontend/src/views/Home.vue
   git checkout frontend/src/api/config.js
   ```

3. **é‡å¯æœåŠ¡**
   ```bash
   # åç«¯
   cd backend && python main.py

   # å‰ç«¯
   cd frontend && npm run dev
   ```

---

## âœ… éªŒæ”¶æ ‡å‡†

### åç«¯
- [ ] åç«¯æ­£å¸¸å¯åŠ¨ï¼Œæ— å¯¼å…¥é”™è¯¯
- [ ] API æ–‡æ¡£ä¸å†æ˜¾ç¤ºé…ç½®æ¥å£
- [ ] å¥åº·æ£€æŸ¥æ¥å£æ­£å¸¸
- [ ] æ— é…ç½®ç›¸å…³ä»£ç å¼•ç”¨

### å‰ç«¯
- [ ] é¦–é¡µæ­£å¸¸æ˜¾ç¤º
- [ ] é…ç½®ç«‹å³åŠ è½½ï¼Œæ—  loading çŠ¶æ€
- [ ] å¯¼èˆªæŒ‰é’®æ­£å¸¸å·¥ä½œ
- [ ] æ—  API é”™è¯¯

### ä»£ç è´¨é‡
- [ ] æ— æ­»ä»£ç 
- [ ] æ— æœªä½¿ç”¨çš„å¯¼å…¥
- [ ] ä»£ç æ ¼å¼æ­£ç¡®

---

## ğŸ“š åç»­ä¼˜åŒ–

1. **ç¯å¢ƒå˜é‡æ”¯æŒ**
   - è€ƒè™‘ä½¿ç”¨ Vite ç¯å¢ƒå˜é‡
   - æ”¯æŒä¸åŒç¯å¢ƒçš„é…ç½®

2. **é…ç½®æ–‡æ¡£**
   - æ›´æ–° CLAUDE.md
   - æ·»åŠ é…ç½®ä¿®æ”¹æŒ‡å—

3. **ä»£ç æ¸…ç†**
   - åˆ é™¤æœªä½¿ç”¨çš„ä¾èµ–
   - ä¼˜åŒ–å¯¼å…¥è¯­å¥

---

## ğŸ¯ å®æ–½é¡ºåº

1. âœ… é˜¶æ®µ 1ï¼šåç«¯æ¸…ç†ï¼ˆåˆ é™¤æ–‡ä»¶ã€ä¿®æ”¹ä»£ç ï¼‰
2. âœ… é˜¶æ®µ 2ï¼šå‰ç«¯æ”¹é€ ï¼ˆä¿®æ”¹ Home.vueï¼‰
3. âœ… é˜¶æ®µ 3ï¼šæ•°æ®åº“å¤„ç†ï¼ˆä¿ç•™è¡¨ï¼‰
4. âœ… é˜¶æ®µ 4ï¼šéªŒè¯æµ‹è¯•ï¼ˆå¯åŠ¨æµ‹è¯•ã€ä»£ç æ£€æŸ¥ï¼‰

---

**é¢„è®¡æ—¶é—´**: 30-45 åˆ†é’Ÿ
**é£é™©ç­‰çº§**: ä½
**å¯å›æ»šæ€§**: é«˜
